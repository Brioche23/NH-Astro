---
interface Props {
  title: string;
  vimeoId: number;
  crediti: object;
}


import Vimeo from './Vimeo.astro';

const {title, vimeoId, crediti} = Astro.props

const videoSizes = ["w-1/2 ml-auto mr-20", "w-1/2 ml-auto mL-20", "w-2/3 ml-auto mr-0", "w-2/3 mR-auto mL-0", "w-1/3 ml-auto mr-0", "w-1/3 mR-auto mL-0"]
// let margins = ['ml-auto mr-0', 'ml-auto mr-20', 'ml-0 mr-auto', 'ml-20 mr-auto'];

const videoId = "video-"+vimeoId;


function getRandomWidth() {
  return videoSizes[Math.floor(Math.random() * videoSizes.length)];
}

// function getRandomMargin() {
//   return margins[Math.floor(Math.random() * margins.length)];
// }

---

<li id={videoId} class={`video-card relative transition-all duration-500 ease-in-out ${getRandomWidth()}`} style="opacity: 1;">
     <Vimeo {vimeoId} {title}/>
     <div class="info-panel grid grid-rows-[0fr] transition-all duration-500 ease-in-out pt-5">
     <div class=" w-full flex overflow-hidden">
      <div class="title w-1/3">
        <p class="text-3xl">
          {title}
        </p>
      </div>
      <div class="credits w-1/3">
       <div class="pb-2">
        <p class="text-orange">Cliente</p>
        <!-- <p>{crediti.cliente}</p> -->
       </div>
       <div class="pb-2">
        <p class="text-purple">Agenzia</p>
        <p>{crediti.agenzia}</p>
       </div>
       <div class="pb-2">
        <p class="text-orange">Regia</p>
        <p>{crediti.regia}</p>
       </div>
       <div class="pb-2">
        <p class="text-purple">Casa di Produzione</p>
        <p>{crediti.casa}</p>
       </div>
       <div class="pb-2">
         <p class="text-orange">Sound Design</p>
         <p>{crediti.soundDesign}</p>
        </div>
        <div class="pb-2">
         <p class="text-purple">Mix</p>
         <p>{crediti.mix}</p>
        </div>
     </div>
      </div>
     </div>
</li>

<script >
     console.log('hello');
     const videoCards = document.querySelectorAll('li.video-card');
     const infoPanels = document.querySelectorAll('.info-panel');
     // Handle clicks on each button.

     videoCards.forEach((card, index) => {
      card.addEventListener('click', () => {
        toggleOpacity(videoCards, index);
        toggleInfo(infoPanels, index);
    
     console.log('toggle');
  });
});

function toggleOpacity(videoCards, index){
  videoCards.forEach((card, i) => {
   if(i!==index){
      card.style.width = card.style.width === '100%' ? '' : '';
      card.style.opacity = card.style.opacity === '1' ? '.5' : '.5';
      console.log(card.style.opacity);
    }
    else{
      card.style.width = card.style.width === '100%' ? '' : '100%';
      card.style.opacity = card.style.opacity === '.5' ? '1' : '';
    }

});
}

function toggleInfo(infoPanels, index){
  infoPanels.forEach((panel, i) => {
   if(i!==index){
      panel.classList.add("grid-rows-[0fr]");
      panel.classList.remove("grid-rows-[1fr]");
    }
    else{
      panel.classList.toggle("grid-rows-[0fr]");
      panel.classList.toggle("grid-rows-[1fr]");
   
    }

});
}

</script>

<style>
.video-card::after {
  content:"";
  position:absolute;
  z-index:2;
  width:100%;
  height:100%;
  left:0;
  top:0;
}
</style>